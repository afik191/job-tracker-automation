name: Manually Test Email Bot

# This workflow is only triggered manually
on:
  workflow_dispatch:

jobs:
  run-email-bot:
    # This job will always run when this workflow is triggered
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'

      # Create the secret files from GitHub Secrets
      - name: Create Google Credentials File
        run: echo "${{ secrets.GOOGLE_CREDENTIALS_JSON }}" > ./credentials.json
      - name: Create Google Token File
        run: echo "${{ secrets.GOOGLE_TOKEN_JSON }}" > ./token.json

      - name: Install Dependencies
        run: npm install

      - name: Run Email Bot
        run: node index.js
        env:
          # Pass all secrets needed by index.js
          TRELLO_API_KEY: ${{ secrets.TRELLO_API_KEY }}
          TRELLO_TOKEN: ${{ secrets.TRELLO_TOKEN }}
          TRELLO_SENT_CV_LIST_ID: ${{ secrets.TRELLO_SENT_CV_LIST_ID }}
          TRELLO_ESTABLISHED_CONTACT_LIST_ID: ${{ secrets.TRELLO_ESTABLISHED_CONTACT_LIST_ID }}
          TRELLO_INITIAL_INTERVIEW_LIST_ID: ${{ secrets.TRELLO_INITIAL_INTERVIEW_LIST_ID }}
          TRELLO_CODING_INTERVIEW_LIST_ID: ${{ secrets.TRELLO_CODING_INTERVIEW_LIST_ID }}
          TRELLO_ARCHITECTURE_INTERVIEW_LIST_ID: ${{ secrets.TRELLO_ARCHITECTURE_INTERVIEW_LIST_ID }}
          TRELLO_MANAGEMENT_AND_HR_LIST_ID: ${{ secrets.TRELLO_MANAGEMENT_AND_HR_LIST_ID }}
          TRELLO_DROPPED_INITIAL_LIST_ID: ${{ secrets.TRELLO_DROPPED_INITIAL_LIST_ID }}
          GROQ_API_KEY: ${{ secrets.GROQ_API_KEY }}
          NTFY_TOPIC: ${{ secrets.NTFY_TOPIC }}
          USER_EMAIL: ${{ secrets.USER_EMAIL }}



    
